<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WPL.FORM.ICT.01 REV 03 ICT Build & Issuance form</title>
    <style>
        @page {
            size: A4;
            margin: 0;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            font-size: 12px;
            line-height: 1.2;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            width: 210mm;
            height: 297mm;
            padding: 10mm;
            box-sizing: border-box;
            position: relative;
            background-color: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 15px;
            border-bottom: 2px solid #2c3e50;
            padding-bottom: 10px;
        }
        .header h1 {
            font-size: 20px;
            margin: 0;
            font-weight: bold;
            color: #2c3e50;
        }
        .header h2 {
            font-size: 16px;
            margin: 5px 0;
            font-weight: bold;
            color: #34495e;
        }
        .section {
            margin-bottom: 12px;
        }
        .section-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 13px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 3px;
        }
        .form-row {
            display: flex;
            align-items: flex-end;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }
        .form-group {
            display: flex;
            align-items: center;
            margin-right: 15px;
            margin-bottom: 5px;
        }
        .form-label {
            font-weight: bold;
            margin-right: 5px;
            white-space: nowrap;
        }
        .form-field {
            border-bottom: 1px solid black;
            min-width: 100px;
            height: 18px;
            padding: 0 5px;
            display: inline-block;
        }
        .form-field-large {
            min-width: 200px;
        }
        .form-field-small {
            min-width: 70px;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-right: 15px;
            margin-bottom: 5px;
        }
        .checkbox-group input[type="checkbox"] {
            margin-right: 5px;
            accent-color: #2c3e50;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 8px 0;
            font-size: 11px;
        }
        table, th, td {
            border: 1px solid black;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
            padding: 5px;
        }
        td {
            padding: 4px;
            text-align: center;
            height: 22px;
        }
        .applications-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px 15px;
            margin-top: 5px;
        }
        .applications-item {
            display: flex;
            align-items: center;
        }
        .applications-item input[type="checkbox"] {
            margin-right: 8px;
            accent-color: #2c3e50;
        }
        hr {
            border-top: 1px solid #aaa;
            margin: 10px 0;
        }
        .signature-box {
            height: 40px;
            border-bottom: 1px solid #000;
        }
        .it-signature {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        .it-personnel {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        .it-personnel-label {
            margin-right: 5px;
            white-space: nowrap;
        }
        .it-personnel-name {
            border-bottom: 1px solid #000;
            padding: 3px;
            min-height: 18px;
            width: 200px;
            display: inline-block;
        }
        .it-signature-line {
            border-top: 1px solid #000;
            width: 250px;
            margin-top: 5px;
        }
        .it-signature-label {
            font-size: 11px;
            text-align: center;
            width: 250px;
            margin-top: 3px;
        }
        .action-buttons {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .btn-print {
            background-color: #3498db;
            color: white;
        }
        .btn-save {
            background-color: #2ecc71;
            color: white;
        }
        .form-instructions {
            font-size: 11px;
            color: #7f8c8d;
            margin-top: 8px;
            font-style: italic;
        }
        @media print {
            body {
                width: 210mm;
                height: 297mm;
                background-color: white;
                box-shadow: none;
            }
            .container {
                width: 210mm;
                height: 297mm;
                padding: 10mm;
                box-shadow: none;
            }
            .no-print {
                display: none;
            }
            .form-field, .it-personnel-name {
                border-bottom: 1px solid #000 !important;
            }
        }
        .nowrap {
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>WESSEX PHARMACEUTICALS LIMITED</h1>
            <h2>PC BUILD AND ISSUE FORM</h2>
        </div>
        
        <!-- PC INFORMATION SECTION -->
        <div class="section">
            <div class="section-title">PC INFORMATION:</div>
            
            <div class="form-row">
                <div class="form-group">
                    <span class="form-label">PC MODEL:</span>
                    <span class="form-field form-field-large">{{ asset.model|default:"" }}</span>
                </div>
                <div class="form-group">
                    <span class="form-label">COMPANY:</span>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.company.name == "WESSEX" %}checked{% endif %}> WESSEX
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.company.name != "WESSEX" %}checked{% endif %}> OTHER
                        {% if asset.company.name != "WESSEX" %}
                        <span class="form-field form-field-small">{{ asset.company.name|default:"" }}</span>
                        {% endif %}
                    </div>
                </div>
                <div class="form-group">
                    <span class="form-label">SERIAL NO:</span>
                    <span class="form-field">{{ asset.serial_number|default:"" }}</span>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <span class="form-label">TYPE:</span>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.type == "laptop" %}checked{% endif %}> NOTEBOOK
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.type == "desktop" %}checked{% endif %}> DESKTOP
                    </div>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <span class="form-label">SPECIFICATIONS: PROCESSOR:</span>
                    <span class="form-field form-field-large">{{ asset.get_processor_display|default:"" }}</span>
                </div>
                <div class="form-group">
                    <span class="form-label">RAM:</span>
                    <span class="form-field">{{ asset.get_ram_display|default:"" }}</span>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <span class="form-label">STORAGE:</span>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.hdd_capacity %}checked{% endif %}> HDD
                        {% if asset.hdd_capacity %}
                        <span class="form-field form-field-small">{{ asset.hdd_capacity|default:"" }}</span>
                        {% endif %}
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.ssd_capacity %}checked{% endif %}> SSD
                        {% if asset.ssd_capacity %}
                        <span class="form-field form-field-small">{{ asset.ssd_capacity|default:"" }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <hr>
        
        <!-- MICROSOFT APPLICATIONS SECTION -->
        <div class="section">
            <div class="section-title">MICROSOFT APPLICATIONS</div>
            
            <div class="form-row">
                <div class="form-group">
                    <span class="form-label">OS VERSION:</span>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.os == "win7" %}checked{% endif %}> Win 7
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.os == "win8.1" %}checked{% endif %}> Win 8
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.os == "win10" %}checked{% endif %}> Win 10
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.os == "win11" %}checked{% endif %}> Win 11
                    </div>
                    <span class="form-label nowrap">OS LICENCE:</span>
                    <span class="form-field">{{ asset.os_licence|default:"" }}</span>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <span class="form-label">OFFICE VERSION:</span>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.office == "2007" %}checked{% endif %}> 2007
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.office == "2010" %}checked{% endif %}> 2010
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.office == "2013" %}checked{%endif %}> 2013
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.office == "2016" %}checked{% endif %}> 2016
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.office == "2019" %}checked{% endif %}> 2019
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if asset.office == "365" %}checked{% endif %}> 365 SUBSCRIPTION
                    </div>
                    <span class="form-label nowrap">OFFICE LICENCE:</span>
                    <span class="form-field">{{ asset.office_licence|default:"" }}</span>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <span class="form-label">MS VISIO:</span>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if "visio" in asset.applications %}checked{% endif %}> YES
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" {% if "visio" not in asset.applications %}checked{% endif %}> NO
                    </div>
                    <span class="form-label">VERSION:</span>
                    <span class="form-field form-field-small">{% if "visio" in asset.applications %}{{ asset.applications.visio.version|default:"" }}{% endif %}</span>
                    <span class="form-label nowrap">VISIO LICENCE:</span>
                    <span class="form-field">{% if "visio" in asset.applications %}{{ asset.applications.visio.licence|default:"" }}{% endif %}</span>
                </div>
            </div>
        </div>
        
        <hr>
        
        <!-- USE ALLOCATION DETAILS SECTION -->
        <div class="section">
            <div class="section-title">USE ALLOCATION DETAILS:</div>
            <table>
                <thead>
                    <tr>
                        <th>PC NAME</th>
                        <th>USER</th>
                        <th>ISSUE DATE</th>
                        <th>STATUS</th>
                        <th>SIGN</th>
                        <th>RETURN DATE</th>
                        <th>STATUS</th>
                        <th>SIGN</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{ asset.name|default:"" }}</td>
                        <td>{{ allocation.employee_allocated.first_name|default:"" }} {{ allocation.employee_allocated.last_name|default:"" }}</td>
                        <td>{{ allocation.allocation_date|date:"d/m/Y"|default:"" }}</td>
                        <td>{{ allocation.get_asset_status_display|default:"" }}</td>
                        <td class="signature-box"></td>
                        <td>{% if allocation.return_date %}{{ allocation.return_date|date:"d/m/Y" }}{% endif %}</td>
                        <td>{% if allocation.return_date %}RETURNED{% endif %}</td>
                        <td class="signature-box"></td>
                    </tr>
                    <!-- Empty rows for future use -->
                    <tr><td></td><td></td><td></td><td></td><td class="signature-box"></td><td></td><td></td><td class="signature-box"></td></tr>
                    <tr><td></td><td></td><td></td><td></td><td class="signature-box"></td><td></td><td></td><td class="signature-box"></td></tr>
                    <tr><td></td><td></td><td></td><td></td><td class="signature-box"></td><td></td><td></td><td class="signature-box"></td></tr>
                    <tr><td></td><td></td><td></td><td></td><td class="signature-box"></td><td></td><td></td><td class="signature-box"></td></tr>
                </tbody>
            </table>
        </div>
        
        <hr>
        
        <!-- OTHER APPLICATIONS SECTION -->
        <div class="section">
            <div class="section-title">OTHER APPLICATIONS & BUSINESS SUPPORT SYSTEMS</div>
            <div class="applications-grid">
                <div class="applications-item">
                    <input type="checkbox" {% if "adobe_reader" in asset.applications %}checked{% endif %}> ADOBE READER
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "java" in asset.applications %}checked{% endif %}> JAVA
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "wireshark" in asset.applications %}checked{% endif %}> WIRESHARK
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "antivirus_sophos" in asset.applications %}checked{% endif %}> ANTIVIRUS (SOPHOS)
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "data_loggers" in asset.applications %}checked{% endif %}> DATA LOGGER(s)
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "zoom" in asset.applications %}checked{% endif %}> ZOOM
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "browser_chrome" in asset.applications %}checked{% endif %}> BROWSER (Chrome Recommended)
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "printers" in asset.applications %}checked{% endif %}> PRINTER(s)
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "other" in asset.applications %}checked{% endif %}> OTHERS
                    {% if asset.other_applications %}
                    <span class="form-field form-field-small">{{ asset.other_applications|default:"" }}</span>
                    {% endif %}
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "anydesk" in asset.applications or "teamviewer" in asset.applications %}checked{% endif %}> ANYDESK/TEAMVIEWER
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "hr_software" in asset.applications %}checked{% endif %}> HR SOFTWARES
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "falcon" in asset.applications %}checked{% endif %}> FALCON
                </div>
                <div class="applications-item">
                    <input type="checkbox" {% if "shared_folders" in asset.applications %}checked{% endif %}> SHARED FOLDERS
                </div>
            </div>
            <div class="form-instructions">Note: Check boxes for applications installed on this device</div>
        </div>
        
        <!-- IT SIGNATURE SECTION -->
        <div class="it-signature">
            <div class="it-personnel">
                <span class="it-personnel-label">IT Personnel Name:</span>
                <span class="it-personnel-name"></span>
            </div>
            <div class="it-signature-line"></div>
            <div class="it-signature-label">IT Department Signature</div>
        </div>
    </div>

    <div class="action-buttons no-print">
        <button class="btn btn-print" onclick="window.print()">Print Form</button>
        <button class="btn btn-save" onclick="saveFormData()">Save Data</button>
    </div>

    <script>
        // Print the form automatically when loaded (optional)
        window.onload = function() {
            // Uncomment the line below if you want the form to print automatically
            // window.print();
        };

        // Function to save form data (for demonstration)
        function saveFormData() {
            alert('Form data would be saved to the database in a real application.');
        }
    </script>
</body>
</html>